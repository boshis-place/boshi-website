@use "shared" as *;

.Events {
  &-title {
    position: relative;
    margin-left: -100px;
    font-size: $font-size5;
    text-shadow: $color-shadow-text 3px 0 4px;
    transform: rotate(-2deg);
    z-index: 1;

    @include desktop {
      font-size: $font-size6;
    }

    > dl {
      display: flex;

      > *:nth-child(1) {
        margin-top: 10px;
        transform: rotate(1deg);
      }

      > *:nth-child(2) {
        margin-left: 15px;
        transform: rotate(3deg);
      }

      > *:nth-child(3) {
        margin-left: -10px;
        margin-top: 40px;
        transform: rotate(2deg);

        dd {
          margin-top: -20px;
        }
      }

      > *:nth-child(4) {
        margin-left: 30px;
        margin-top: 60px;
        transform: rotate(-1deg);
      }
    }
  }

  $content: null;

  &-content {
    $content: &;

    position: relative;
    display: flex;
    flex-direction: column;
    gap: $spacing5;
    margin-top: $spacing3;
    padding: $spacing3 $spacing4;
  }

  &-background {
    @include fill();
    @include background();

    box-shadow: 10px 10px 60px $color-shadow-page;
    transition: transform 0.3s;

    #{$content}:hover & {
      transform: skew(+0.05deg, -0.5deg);
    }
  }

  &-border {
    @include fill();

    transition: transform 0.3s;

    #{$content}:hover & {
      transform: skew(-0.05deg, +0.5deg);
    }
  }

  &-list {
    position: relative;
  }
}

.EventsWord {
  position: relative;

  &:hover {
    color: $blue0;
    z-index: 1;
  }

  &:hover &-text {
    animation: Jump 0.3s ease-in-out;
  }

  &--small dt {
    font-size: $font-size2;
  }

  dd {
    position: absolute;
    visibility: hidden;
    font-size: $font-size0;
    transform: rotate(calc(-3deg + var(--rand) * 6deg));
  }

  &:hover dd {
    visibility: visible;
  }

  @keyframes Jump {
    0% {
      transform: translateY(+0px);
    }

    50% {
      transform: translateY(-10px);
    }

    100% {
      transform: translateY(0px);
    }
  }
}

.EventList {
  $list: & !global;

  &-header {
    display: flex;
    align-items: center;
    gap: $spacing2;
    margin-bottom: $spacing2;
  }

  &-title {
    font-size: $font-size2;
    text-shadow: $color-shadow-text 3px 0 4px;

    @include desktop {
      font-size: $font-size3;
    }
  }

  &-items {
    display: flex;
    flex-direction: column;
    gap: $spacing4;

    @include desktop {
      gap: $spacing0;
    }
  }
}

.EventCard {
  $c: &;

  $poster-width: 200px;

  position: relative;
  display: flex;
  // align-items: center;
  flex-direction: column;
  min-height: $poster-width;
  gap: $spacing2;
  opacity: max(calc(1 - var(--index) * 0.02), 0.1);
  transition: opacity 0.3s;

  @include desktop {
    // flex-direction: row;
    // width: $desktop-max;
    margin-left: calc(
      min(var(--index) / 32, 1) * (var(--rand) - 0.5) * 2 * 30vw
    );

    padding-left: $poster-width + $spacing2;
  }

  &:hover {
    opacity: 1;
    z-index: 420 !important;
  }

  /* TODO: this won't work on older browsers; maybe need a js fallback solution */
  #{$list}:has(input:checked) & {
    margin-left: 0px !important;
    opacity: 0.9 !important;
  }

  // &-anchor {
  //   display: contents;
  //   color: $black;
  // }

  &-poster {
    @include flex-center;

    position: absolute;
    left: 0;
  }

  &-posterFrame {
    $poster-rotate: (
      translateX(calc(-10px + var(--rand) * 20px))
        rotate(calc(-1deg + var(--rand) * 2deg))
    );

    position: relative;
    display: flex;
    align-items: center;
    width: $poster-width;
    height: $poster-width;
    transform: $poster-rotate;
    transition: transform 0.3s;

    #{$c}:hover & {
      transform: $poster-rotate skew(-2deg, -2deg);
    }

    & > img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: $radius0;
    }
  }

  &-posterBoshi {
    $rot-dist: calc($poster-width / 2 * sqrt(2));
    $rot-min: 90deg;
    $rot-span: 180deg;

    position: absolute;
    height: 50px;
    z-index: -1;
    transition: transform 0.3s;

    > img {
      width: 100%;
      height: 100%;
      filter: drop-shadow(0px 0px 10px $color-shadow-card);
    }

    #{$c}:hover & {
      transform: (
        translateX(calc($rot-dist * cos($rot-min + var(--rand) * $rot-span)))
          translateY(calc($rot-dist * sin($rot-min + var(--rand) * $rot-span)))
      );
    }
  }

  &-body {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    // align-items: end;
    flex: 1;
    // min-height: 140px;
    // gap: $spacing1;
    // gap: $spacing2;
    // padding: $spacing2;
    transform-origin: left center;
    transform: rotate(calc(-8deg + var(--rand) * 16deg));
    // box-shadow: 10px 10px 20px $color-shadow-card;
    // mix-blend-mode: hard-light;
    transition: transform 0.3s;

    #{$c}:hover & {
      transform: skew(-1deg, -1deg);
    }
  }

  &-text {
    order: 3;
    position: relative;
    padding: $spacing1;
    box-shadow: 10px 10px 20px $color-shadow-card;
    max-width: 500px;
    margin-top: $spacing2;
  }

  &-bg {
    @include background($riso: 6);
    @include fill();

    opacity: 0.6;
    z-index: -1;
    filter: blur(10px);
  }

  &-title {
    // position: absolute;
    position: relative;
    display: flex;
    align-items: baseline;
    // gap: $spacing1;
    z-index: 1;

    @include desktop {
      flex-direction: column-reverse;
      margin-left: -100px;
    }
  }

  &-name {
    order: 2;
    position: relative;
    left: -30px;
    font-size: $font-size2;
    text-shadow: $color-shadow-text 3px 0 1px;
    text-decoration: underline $coral 2px;

    #{$c}:hover & {
      &::before {
        content: "";

        @include background($riso: 3, $color: rgba($coral, 0.4));

        position: absolute;
        left: 0;
        right: 0;
        top: $spacing2;
        bottom: $spacing2;
        z-index: -1;
      }
    }
  }

  &-date {
    order: 1;
    position: relative;
    // position: absolute;
    // font-size: $font-size4;
    text-transform: lowercase;
    color: $white;
    mix-blend-mode: difference;
    text-shadow: $color-shadow-text 3px 0 4px;

    #{$c}:hover & {
      // color: $black;
      // font-size: 3rem;
      // animation: Show 1s infinite both;
    }

    @include mobile {
      top: -35px;
      left: -20px;
      transform: rotate(-2deg);
    }

    @include desktop {
      // top: -20px;
      left: -60px;
      font-size: 1.8rem;
      // top: 0;
      // bottom: 0;
      // padding-left: $spacing4;
      // padding-right: $spacing4;
      // font-size: 8rem;
      // text-align: right;
      // white-space: nowrap;
      // transform: scale(80%);
    }

    @keyframes Show {
      0% {
        transform: identity;
      }

      100% {
        transform: translateX(100%);
      }
    }
  }
}
